variables:
  POETRY_VIRTUALENVS_CREATE: "false"  # This is to ensure poetry uses the system Python
  POSTGRES_DB: edu
  POSTGRES_USER: admin
  POSTGRES_PASSWORD: admin
  DJANGO_DATABASE_HOST: postgres


services:
  - name: postgres:latest
    alias: postgres

stages:
  - test

before_script:
  - pip install -U pip setuptools
  - pip install --upgrade poetry
  - poetry install


pytest:
  stage: test
  script:
    - poetry run python manage.py migrate
    - poetry run pytest



